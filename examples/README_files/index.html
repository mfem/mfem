<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>MFEM: Example Codes</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">MFEM
   &#160;<span id="projectnumber">v3.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Example Codes </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This file provides a brief overview of the MFEM example codes. For detailed documentation of the MFEM sources, including the examples, build the <a href="../../doc/CodeDocumentation/html/index.html">Doxygen documentation</a> in the <code>doc/</code> directory, or browse the <a href="http://doxygen.mfem.googlecode.com/hg/html/index.html">online version</a>.</p>
<p>Clicking on any of the categories below displays examples that contain the described feature. <em> All examples support (arbitrarily) high-order meshes and finite element spaces</em>. The numerical results from the example codes can be visualized using the GLVis visualization tool (based on MFEM). See the <a href="http://glvis.googlecode.com">GLVis website</a>, for more details.</p>
<p>Users are encouraged to submit any example codes that they have created and would like to share. <em>Contact a member of the MFEM team to report <a href="http://code.google.com/p/mfem/issues/entry?template=Defect%20report%20from%20user">bugs</a> or post <a href="http://code.google.com/p/mfem/issues/entry?template=Question%20or%20Comment">questions or comments</a></em>.</p>
 
<hr>
<div id="filters" style="overflow:auto">
<div id="column1" style="float:left; width:16%;">
   <h4>Equation (PDE)</h4>
   <label><input type="radio" id="all1" onchange="update(this.id);" checked="checked" />All</label><br/>
   <label><input type="radio" id="laplace" onchange="update(this.id);" />Laplace</label><br/>
   <label><input type="radio" id="elasticity" onchange="update(this.id);" />Elasticity</label><br/>
   <label><input type="radio" id="maxwell" onchange="update(this.id);" />Definite Maxwell</label><br/>
   <label><input type="radio" id="graddiv" onchange="update(this.id);" />grad-div</label><br/>
   <label><input type="radio" id="darcy" onchange="update(this.id);" />Darcy</label><br/>
   <label><input type="radio" id="advection" onchange="update(this.id);" />Advection</label><br/>
</div>

<div id="column2" style="float:left; width:26%;">
   <h4>Finite Elements</h4>
   <label><input type="radio" id="all2" onchange="update(this.id);" checked="checked" />All</label><br/>
   <label><input type="radio" id="l2" onchange="update(this.id);" /><img src="L2.png", style="vertical-align:text-bottom;"> discontinuous elements</label><br/>
   <label><input type="radio" id="h1" onchange="update(this.id);" /><img src="H1.png", style="vertical-align:text-bottom;"> nodal elements</label><br/>
   <label><input type="radio" id="hcurl" onchange="update(this.id);" /><img src="Hcurl.png", style="vertical-align:text-bottom;"> Nedelec elements</label><br/>
   <label><input type="radio" id="hdiv" onchange="update(this.id);" /><img src="Hdiv.png", style="vertical-align:text-bottom;"> Raviart-Thomas elements</label><br/>
   <label><input type="radio" id="h12" onchange="update(this.id);" /><img src="H12.png", style="vertical-align:text-bottom;"> interfacial elements</label><br/>
</div>

<div id="column3" style="float:left; width:29%">
   <h4>Discretization</h4>
  <label><input type="radio" id="all3" onchange="update(this.id);" checked="checked" />All</label><br/>
   <label><input type="radio" id="galerkin" onchange="update(this.id);" />Galerkin FEM</label><br/>
   <label><input type="radio" id="mixed" onchange="update(this.id);" />Mixed FEM</label><br/>
   <label><input type="radio" id="dg" onchange="update(this.id);" />Discontinuous Galerkin (DG)</label><br/>
   <label><input type="radio" id="dpg" onchange="update(this.id);" />Discontinuous Petrov-Galerkin (DPG)</label><br/>
   <label><input type="radio" id="nurbs" onchange="update(this.id);" />Isogeometric analysis (NURBS)</label><br/>
   <label><input type="radio" id="amr" onchange="update(this.id);" />Adaptive mesh refinement (AMR)</label><br/>
</div>

<div id="column4" style="float:left; width:29%">
   <h4>Solver</h4>
   <label><input type="radio" id="all4" onchange="update(this.id);" checked="checked" />All</label><br/>
   <label><input type="radio" id="jacobi" onchange="update(this.id);" />Jacobi</label> <br/>
   <label><input type="radio" id="gs" onchange="update(this.id);" />Gauss-Seidel</label> <br/>
   <label><input type="radio" id="pcg" onchange="update(this.id);" />PCG</label> <br/>
   <label><input type="radio" id="minres" onchange="update(this.id);" />MINRES</label> <br/>
   <label><input type="radio" id="amg" onchange="update(this.id);" />Algebraic Multigrid (BoomerAMG)</label> <br/>
   <label><input type="radio" id="ams" onchange="update(this.id);" />Auxiliary-space Maxwell Solver (AMS)</label> <br/>
   <label><input type="radio" id="ads" onchange="update(this.id);" />Auxiliary-space Divergence Solver (ADS)</label> <br/>
   <label><input type="radio" id="umfpack" onchange="update(this.id);" />UMFPACK (serial direct)</label><br/>
   <label><input type="radio" id="newton" onchange="update(this.id);" />Newton method (nonlinear solver)</label><br/>
   <label><input type="radio" id="rk" onchange="update(this.id);" />Explicit Runge-Kutta (ODE integration)</label><br/>
   <label><input type="radio" id="sdirk" onchange="update(this.id);" />Implicit Runge-Kutta (ODE integration)</label><br/>
</div>
</div>
<div id="ex1">  <hr style="clear:both;"/><img src="ex1.png" style="float:right;">  <h2>Example 1: Laplace Problem</h2>
</div><div id="ex1"></div><div id="ex1">This example code demonstrates the use of MFEM to define a simple isoparametric finite element discretization of the Laplace problem </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ -\Delta u = 1 \]" src="form_0.png"/>
</p>
<p> with homogeneous Dirichlet boundary conditions. Specifically, we discretize with the FE space coming from the mesh (linear by default, quadratic for quadratic curvilinear mesh, NURBS for NURBS mesh, etc.) </div><div id="ex1"> The example highlights the use of mesh refinement, finite element grid functions, as well as linear and bilinear forms corresponding to the left-hand side and right-hand side of the discrete linear system. We also cover the explicit elimination of boundary conditions on all boundary edges, and the optional connection to the <a href="http://glvis.googlecode.com">GLVis</a> tool for visualization. </p>
<center> <em>The example has a serial (ex1.cpp) and a parallel (ex1p.cpp) version.</em> </center> </div><div id="ex1"> </div><div id="ex2">  <hr style="clear:both;"/><img src="ex2.png" style="float:right;">  <h2>Example 2: Linear Elasticity</h2>
</div><div id="ex2"></div><div id="ex2">This example code solves a simple linear elasticity problem describing a multi-material cantilever beam. Specifically, we approximate the weak form of </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ -{\rm div}({\sigma}({\bf u})) = 0 \]" src="form_1.png"/>
</p>
<p> where </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ {\sigma}({\bf u}) = \lambda\, {\rm div}({\bf u})\,I + \mu\,(\nabla{\bf u} + \nabla{\bf u}^T) \]" src="form_2.png"/>
</p>
<p> is the stress tensor corresponding to displacement field <img class="formulaInl" alt="${\bf u}$" src="form_3.png"/>, and <img class="formulaInl" alt="$\lambda$" src="form_4.png"/> and <img class="formulaInl" alt="$\mu$" src="form_5.png"/> are the material Lame constants. The boundary conditions are <img class="formulaInl" alt="${\bf u}=0$" src="form_6.png"/> on the fixed part of the boundary with attribute 1, and <img class="formulaInl" alt="${\sigma}({\bf u})\cdot n = f$" src="form_7.png"/> on the remainder with <img class="formulaInl" alt="$f$" src="form_8.png"/> being a constant pull down vector on boundary elements with attribute 2, and zero otherwise. The geometry of the domain is assumed to be as follows: </p>
<div class="image">
<img src="ex2-domain.png" />
</div>
<p> The example demonstrates the use of high-order and NURBS vector finite element spaces with the linear elasticity bilinear form, meshes with curved elements, and the definition of piece-wise constant and vector coefficient objects. </p>
<center> <em>The example has a serial (ex2.cpp) and a parallel (ex2p.cpp) version. We recommend viewing Example 1 before viewing this example. </em> </center> </div><div id="ex3">  <hr style="clear:both;"/><img src="ex3.png" style="float:right;">  <h2>Example 3: Definite Maxwell Problem</h2>
</div><div id="ex3"></div><div id="ex3">This example code solves a simple 3D electromagnetic diffusion problem corresponding to the second order definite Maxwell equation </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ {\rm curl\, curl}\, E + E = f \]" src="form_9.png"/>
</p>
<p> with boundary condition <img class="formulaInl" alt="$ E \times n $" src="form_10.png"/> = "given tangential field". Here, we use a given exact solution <img class="formulaInl" alt="$E$" src="form_11.png"/> and compute the corresponding r.h.s. <img class="formulaInl" alt="$f$" src="form_8.png"/>. We discretize with Nedelec finite elements. </div><div id="ex3"> The example demonstrates the use of  <img src="Hcurl.png", style="vertical-align:text-bottom;">  finite element spaces with the curl-curl and the (vector finite element) mass bilinear form, as well as the computation of discretization error when the exact solution is known. </p>
<center> <em>The example has a serial (ex3.cpp) and a parallel (ex3p.cpp) version. We recommend viewing examples 1-2 before viewing this example.</em> </center> </div><div id="ex4">  <hr style="clear:both;"/><img src="ex4.png" style="float:right;">  <h2>Example 4: grad-div Problem</h2>
</div><div id="ex4"></div><div id="ex4">This example code solves a simple 2D/3D  <img src="Hdiv.png", style="vertical-align:text-bottom;">  diffusion problem corresponding to the second order definite equation </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ -{\rm grad}(\alpha\,{\rm div}(F)) + \beta F = f \]" src="form_12.png"/>
</p>
<p> with boundary condition <img class="formulaInl" alt="$F \cdot n$" src="form_13.png"/> = "given normal field". Here, we use a given exact solution <img class="formulaInl" alt="$F$" src="form_14.png"/> and compute the corresponding r.h.s. <img class="formulaInl" alt="$f$" src="form_8.png"/>. We discretize with the Raviart-Thomas finite elements. </div><div id="ex4"> The example demonstrates the use of  <img src="Hdiv.png", style="vertical-align:text-bottom;">  finite element spaces with the grad-div and  <img src="Hdiv.png", style="vertical-align:text-bottom;">  vector finite element mass bilinear form, as well as the computation of discretization error when the exact solution is known. </p>
<center> <em>The example has a serial (ex4.cpp) and a parallel (ex4p.cpp) version. We recommend viewing examples 1-3 before viewing this example.</em> </center> </div><div id="ex5">  <hr style="clear:both;"/><img src="ex5.png" style="float:right;">  <h2>Example 5: Darcy Problem</h2>
</div><div id="ex5"></div><div id="ex5">This example code solves a simple 2D/3D mixed Darcy problem corresponding to the saddle point system </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{array}{rcl} k\,{\bf u} + {\rm grad}\,p &amp;=&amp; f\\ -{\rm div}\,{\bf u} &amp;=&amp; g \end{array} \]" src="form_15.png"/>
</p>
<p> with natural boundary condition <img class="formulaInl" alt="$-p$" src="form_16.png"/> = "given pressure". Here, we use a given exact solution <img class="formulaInl" alt="$({\bf u},p)$" src="form_17.png"/> and compute the corresponding r.h.s. <img class="formulaInl" alt="$(f, g)$" src="form_18.png"/>. We discretize with Raviart-Thomas finite elements (velocity <img class="formulaInl" alt="$\bf u$" src="form_19.png"/>) and piecewise discontinuous polynomials (pressure <img class="formulaInl" alt="$p$" src="form_20.png"/>). </div><div id="ex5"> The example demonstrates the use of the BlockMatrix and BlockOperator classes, as well as the collective saving of several grid functions in a <a href="http://visit.llnl.gov">VisIt</a> visualization format. </p>
<center> <em>The example has a serial (ex5.cpp) and a parallel (ex5p.cpp) version. We recommend viewing examples 1-4 before viewing this example.</em> </center> </div><div id="ex6">  <hr style="clear:both;"/><img src="ex6.png" style="float:right;">  <h2>Example 6: Laplace Problem with AMR</h2>
</div><div id="ex6"></div><div id="ex6">This is a version of Example 1 with a simple adaptive mesh refinement loop. The problem being solved is again the Laplace equation </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ -\Delta u = 1 \]" src="form_0.png"/>
</p>
<p> with homogeneous Dirichlet boundary conditions. The problem is solved on a sequence of meshes which are locally refined in a conforming (triangles, tetrahedrons) or non-conforming (quadrilateral, hexahedrons) manner according to a simple ZZ error estimator. </div><div id="ex6"> The example demonstrates MFEM's capability to work with both conforming and nonconforming refinements, in 2D and 3D, on linear, curved and surface meshes. Interpolation of functions from coarse to fine meshes, as well as persistent <a href="http://glvis.googlecode.com">GLVis</a> visualization are also illustrated. </p>
<center> <em>The example currently has only a serial version (ex6.cpp). We recommend viewing Example 1 before viewing this example. </em> </center> </div><div id="ex7">  <hr style="clear:both;"/><img src="ex7.png" style="float:right;">  <h2>Example 7: Surface Meshes</h2>
</div><div id="ex7"></div><div id="ex7">This example code demonstrates the use of MFEM to define a triangulation of a unit sphere and a simple isoparametric finite element discretization of the Laplace problem with mass term, </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ -\Delta u + u = f. \]" src="form_21.png"/>
</p>
 </div><div id="ex7"> The example highlights mesh generation, the use of mesh refinement, high-order meshes and finite elements, as well as surface-based linear and bilinear forms corresponding to the left-hand side and right-hand side of the discrete linear system. </p>
<center> <em>The example has a serial (ex7.cpp) and a parallel (ex7p.cpp) version. We recommend viewing Example 1 before viewing this example.</em> </center> </div><div id="ex8">  <hr style="clear:both;"/><img src="ex8.png" style="float:right;">  <h2>Example 8: DPG for the Laplace Problem</h2>
</div><div id="ex8"></div><div id="ex8">This example code demonstrates the use of the Discontinuous Petrov-Galerkin (DPG) method in its primal 2x2 block form as a simple finite element discretization of the Laplace problem </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ -\Delta u = f \]" src="form_22.png"/>
</p>
<p> with homogeneous Dirichlet boundary conditions. We use high-order continuous trial space, a high-order interfacial (trace) space, and a high-order discontinuous test space defining a local dual ( <img class="formulaInl" alt="$H^{-1}$" src="form_23.png"/>) norm. </div><div id="ex8"> The example highlights the use of interfacial (trace) finite elements and spaces, trace face integrators and the definition of block operators and preconditioners. </p>
<center> <em>The example has a serial (ex8.cpp) and a parallel (ex8p.cpp) version. We recommend viewing examples 1-5 before viewing this example.</em> </center> </div><div id="ex9">  <hr style="clear:both;"/><img src="ex9.png" style="float:right;">  <h2>Example 9: DG Advection</h2>
</div><div id="ex9"></div><div id="ex9">This example code solves the time-dependent advection equation </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{du}{dt} = v \cdot \nabla u, \]" src="form_24.png"/>
</p>
<p> where <img class="formulaInl" alt="$v$" src="form_25.png"/> is a given fluid velocity, and <img class="formulaInl" alt="$u_0(x)=u(0,x)$" src="form_26.png"/> is a given initial condition. </div><div id="ex9"> The example demonstrates the use of Discontinuous Galerkin (DG) bilinear forms in MFEM (face integrators), the use of explicit ODE time integrators, the definition of periodic boundary conditions through periodic meshes, as well as the use of <a href="http://glvis.googlecode.com">GLVis</a> for persistent visualization of a time-evolving solution. The saving of time-dependent data files for external visualization with <a href="http://visit.llnl.gov">VisIt</a> is also illustrated. </p>
<center> <em>The example has a serial (ex9.cpp) and a parallel (ex9p.cpp) version.</em> </center> </div><div id="ex10">  <hr style="clear:both;"/><img src="ex10.png" style="float:right;">  <h2>Example 10: Nonlinear Elasticity</h2>
</div><div id="ex10"></div><div id="ex10">This examples solves a time dependent nonlinear elasticity problem of the form </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{dv}{dt} = H(x) + S v\,,\qquad \frac{dx}{dt} = v\,, \]" src="form_27.png"/>
</p>
<p> where <img class="formulaInl" alt="$H$" src="form_28.png"/> is a hyperelastic model and <img class="formulaInl" alt="$S$" src="form_29.png"/> is a viscosity operator of Laplacian type. The geometry of the domain is assumed to be as follows: </p>
<div class="image">
<img src="ex10-domain.png" />
</div>
 </div><div id="ex10"> The example demonstrates the use of nonlinear operators, as well as their implicit time integration using a Newton method for solving an associated reduced backward-Euler type nonlinear equation. Each Newton step requires the inversion of a Jacobian matrix, which is done through a (preconditioned) inner solver. </p>
<center> <em>The example has a serial (ex10.cpp) and a parallel (ex10p.cpp) version. We recommend viewing examples 2 and 9 before viewing this example.</em> </center> </div><div id="nomatch"><hr/>
<p> <br/>
<br/>
<br/>
 </p>
<center> No examples match your criteria. </center><p> <br/>
<br/>
<br/>
 </div> 
<div style="clear:both;"/></div>
<script type="text/javascript"><!--
function isChecked(id)
{
    return document.getElementById(id).checked;
}

function setChecked(id, value)
{
    document.getElementById(id).checked = value;
}

function showElement(id, show)
{
    //document.getElementById(id).style.display = show ? "block" : "none";

    // workaround because Doxygen splits and duplicates the divs for some reason
    var divs = document.getElementsByTagName("div");
    for (i = 0; i < divs.length; i++)
        if (divs.item(i).id == id)
            divs.item(i).style.display = show ? "block" : "none";
}

function updateGroup(names, id)
{
   // make only one box checked in the group
   if (names.indexOf(id) != -1)
      for (i = 0; i < names.length; ++i)
         setChecked(names[i], id == names[i]);

   // generate boolean variables from the group names
   for (i = 0; i < names.length; ++i)
      this[names[i]] = isChecked(names[i]) || isChecked(names[0]);
}

function elementVisible(id)
{
   var elem = document.getElementById(id);
   return elem != null && elem.style.display != "none";
}

function exampleVisible(num)
{
   return elementVisible("ex"+num);// || elementVisible("ex"+num+"p");
}

function update(id)
{
   var group1 = ["all1", "laplace", "elasticity", "maxwell", "graddiv", "darcy", "advection"];
   var group2 = ["all2", "l2", "h1", "hcurl", "hdiv", "h12"];
   var group3 = ["all3", "galerkin", "mixed", "dg", "dpg", "nurbs", "amr" ];
   var group4 = ["all4", "jacobi", "gs", "pcg", "minres", "amg", "ams", "ads", "umfpack", "newton", "rk", "sdirk"];

   updateGroup(group1, id);
   updateGroup(group2, id);
   updateGroup(group3, id);
   updateGroup(group4, id);

   showElement("ex1",  laplace && h1 && (galerkin || nurbs) && (gs || pcg || umfpack || amg));
   showElement("ex2",  elasticity && h1 && (galerkin || nurbs) && (gs || pcg || umfpack || amg));
   showElement("ex3",  maxwell && hcurl && galerkin && (gs || pcg || umfpack || ams));
   showElement("ex4",  graddiv && hdiv && galerkin && (gs || pcg || umfpack || ads || ams));
   showElement("ex5",  darcy && (l2 || hdiv) && mixed && (gs || jacobi || minres || umfpack || amg ));
   showElement("ex6",  laplace && h1 && (galerkin || nurbs || amr) && (gs || pcg || umfpack));
   showElement("ex7",  laplace && h1 && galerkin && (gs || pcg || umfpack || amg));
   showElement("ex8",  laplace && (l2 || h1 || h12) && dpg && (gs || pcg || umfpack || amg));
   showElement("ex9",  advection && l2 && dg && (pcg || rk));
   showElement("ex10", elasticity && (l2 || h1) && galerkin && (jacobi || pcg || minres || umfpack || newton || rk || sdirk));

   // NOTE: update 'numExamples' below when adding examples!
   var numExamples = 10;
   var allHidden = true;
   for (i = 1; i <= numExamples; i++) {
      if (exampleVisible(i)) {
         allHidden = false;
         break;
      }
   }
   showElement("nomatch", allHidden);
}

// make sure "no match" div is not visible after page is loaded
window.onload = update;

// force vertical scrollbar
document.getElementsByTagName("body")[0].style = "overflow-y: scroll"

//--></script>
 </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jan 29 2015 17:02:29 for MFEM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
